<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Party Buzzer - TV/Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Party Buzzer: interface TV/Admin en direct." />
  <link rel="stylesheet" href="/style.css" />
</head>
<body class="tv-body">
  <main class="container tv-layout-3 tight">
    <header class="tv-header card">
      <div class="tv-header-left"><h1 style="margin:0;">Party Buzzer</h1></div>
      <div class="tv-header-right">
        <div class="mode-switch" id="modeSwitch">
          <label class="mode-pill"><input type="radio" name="mode" value="buzzer" checked /> Buzzer</label>
          <label class="mode-pill"><input type="radio" name="mode" value="quiz" /> Quiz V/F</label>
          <label class="mode-pill"><input type="radio" name="mode" value="guess" /> Devine</label>
          <label class="mode-pill"><input type="radio" name="mode" value="free" /> Réponse libre</label>
        </div>
      </div>
    </header>

    <!-- Colonne gauche -->
    <aside class="tv-left card">
      <section class="tv-room">
        <div class="row" style="display:flex; align-items:center; justify-content:space-between; gap:.8rem;">
          <div>
            <div class="hint">Code de salle</div>
            <div class="code" id="roomCode"></div>
          </div>
          <div class="tv-qr">
            <a id="qrLink" href="#" target="_blank" rel="noopener" title="Ouvrir la page de join">
              <img id="qr" alt="QR code vers /join" width="120" height="120" />
            </a>
          </div>
        </div>
        <div class="row" style="display:flex; gap:.6rem; flex-wrap:wrap;">
          <button id="regenBtn" title="Regénérer la salle">Nouvelle salle</button>
        </div>
        <p class="row"><a href="/">Retour à l'accueil</a></p>
      </section>

      <section class="tv-status-box">
        <div id="status" class="tv-status" aria-live="polite"></div>
      </section>
    </aside>

    <!-- Centre -->
    <section class="tv-center">
      <!-- Buzzer -->
      <section id="buzzerPanel" class="card" data-game-panel="buzzer">
        <h2>Buzzer</h2>
        <div class="row btn-row">
          <button id="startRoundBtn" class="btn-green">Démarrer le tour</button>
          <button id="resetRoundBtn">Réinitialiser le tour</button>
        </div>
      </section>

      <!-- Quiz -->
      <section id="quizPanel" class="card" style="display:none;" data-game-panel="quiz">
        <h2>Quiz Vrai/Faux</h2>

        <div class="card soft">
          <h3 style="margin-top:0;">Banque de questions</h3>
          <div class="row btn-row">
            <button id="quizLoadBtn">Charger banque</button>
            <span id="quizLoadedInfo" class="hint"></span>
          </div>
        </div>

        <div class="field">
          <label>Question</label>
          <input id="quizQuestion" type="text" placeholder="Ex: Le Soleil est une étoile ?" />
        </div>
        <div class="row btn-row">
          <label><input type="radio" name="quizCorrect" id="quizTrue" value="true" checked /> Vrai</label>
          <label><input type="radio" name="quizCorrect" id="quizFalse" value="false" /> Faux</label>
        </div>
        <div class="row btn-row" style="flex-wrap:wrap;">
          <div class="field" style="min-width:160px; max-width:220px;">
            <label>Durée (secondes)</label>
            <input id="quizSeconds" type="number" min="1" max="30" value="5" />
          </div>
          <div class="field" style="min-width:160px; max-width:220px;">
            <label>Questions dans la série</label>
            <input id="quizSeriesCount" type="number" min="1" max="50" value="10" />
          </div>
        </div>
        <div class="row btn-row">
          <button id="quizStartBtn" class="btn-green">Poser (3-2-1)</button>
          <button id="quizRandomAskBtn" class="btn-cyan">Question aléatoire</button>
          <button id="quizSeriesBtn" class="btn-cyan">Lancer une série</button>
        </div>
        <div id="quizInfo" class="row hint"></div>
      </section>

      <!-- Devine -->
      <section id="guessPanel" class="card" style="display:none;" data-game-panel="guess">
        <h2>Devine le nombre</h2>

        <div class="card soft">
          <h3 style="margin-top:0;">Banque</h3>
          <div class="row btn-row">
            <button id="guessLoadBtn">Charger banque</button>
            <span id="guessLoadedInfo" class="hint"></span>
          </div>
        </div>

        <div class="field">
          <label>Question</label>
          <input id="guessQuestion" type="text" placeholder="Ex: Combien font 7 x 8 ?" />
        </div>
        <div class="row btn-row" style="flex-wrap:wrap;">
          <div class="field" style="min-width:140px;">
            <label>Réponse correcte</label>
            <input id="guessCorrect" type="number" value="56" />
          </div>
          <div class="field" style="min-width:140px;">
            <label>Min</label>
            <input id="guessMin" type="number" value="0" />
          </div>
          <div class="field" style="min-width:140px;">
            <label>Max</label>
            <input id="guessMax" type="number" value="100" />
          </div>
          <div class="field" style="min-width:140px;">
            <label>Durée (s)</label>
            <input id="guessSeconds" type="number" min="1" max="60" value="8" />
          </div>
          <div class="field" style="min-width:160px; max-width:220px;">
            <label>Questions dans la série</label>
            <input id="guessSeriesCount" type="number" min="1" max="50" value="10" />
          </div>
        </div>
        <div class="row btn-row">
          <button id="guessStartBtn" class="btn-green">Poser (3-2-1)</button>
          <button id="guessRandomAskBtn" class="btn-cyan">Question aléatoire</button>
          <button id="guessSeriesBtn" class="btn-cyan">Lancer une série</button>
        </div>
        <div id="guessInfo" class="row hint"></div>

        <div class="field">
          <label>Répartition des réponses</label>
          <div id="guessChart" class="chart"></div>
          <div id="guessScale" class="chart-scale"><span>Min</span><span>Max</span></div>
        </div>
      </section>

      <!-- Réponse libre -->
      <section id="freePanel" class="card" style="display:none;" data-game-panel="free">
        <h2>Réponse libre</h2>

        <div class="card soft">
          <h3 style="margin-top:0;">Banque</h3>
          <div class="row btn-row">
            <button id="freeLoadBtn">Charger banque</button>
            <span id="freeLoadedInfo" class="hint"></span>
          </div>
        </div>

        <div class="field">
          <label>Question</label>
          <input id="freeQuestion" type="text" placeholder="Ex: Écris une définition drôle de 'internet'." />
        </div>
        <div class="row btn-row" style="flex-wrap:wrap;">
          <div class="field" style="min-width:160px; max-width:220px;">
            <label>Durée (secondes)</label>
            <input id="freeSeconds" type="number" min="5" max="180" value="30" />
          </div>
          <div class="field" style="min-width:160px; max-width:220px;">
            <label>Questions dans la série</label>
            <input id="freeSeriesCount" type="number" min="1" max="50" value="20" />
          </div>
        </div>
        <div class="row btn-row">
          <button id="freeStartBtn" class="btn-green">Poser (3-2-1)</button>
          <button id="freeRandomAskBtn" class="btn-cyan">Question aléatoire</button>
          <button id="freeSeriesBtn" class="btn-cyan">Lancer une série</button>
        </div>
        <div id="freeInfo" class="row hint"></div>
      </section>
    </section>

    <!-- Droite: Scores -->
    <aside class="tv-right card">
      <section class="tv-scores">
        <h2>Scores</h2>
        <ul id="players" class="score-list"></ul>
        <div class="score-footer">
          <button id="resetScoresBtn" class="btn-cyan">Réinitialiser scores</button>
        </div>
      </section>
    </aside>
  </main>

  <!-- Overlays globaux -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true" onclick="this.classList.remove('show')">
    <div>
      <div class="label">Gagnant</div>
      <div id="winnerName" class="winner"></div>
      <div class="hint">(cliquer pour fermer)</div>
    </div>
  </div>

  <div id="countdown" class="overlay" role="status" aria-live="assertive">
    <div>
      <div class="label">Début dans</div>
      <div id="countNum" class="winner"></div>
    </div>
  </div>

  <div id="quizQOverlay" class="overlay" role="dialog" aria-modal="true">
    <button id="overlayStopBtn" class="overlay-stop" title="Arrêter l'auto‑play">✖</button>
    <div>
      <div class="label">Question</div>
      <div id="quizQText" class="question"></div>
      <div id="quizTimer" class="hint" style="margin-top:.8rem;"></div>
      <div id="freeHint" class="hint" style="margin-top: .6rem; display:none;">Écrivez votre réponse sur votre téléphone</div>
    </div>
  </div>

  <div id="freeResultsOverlay" class="overlay">
    <div style="max-width: 1000px; width: 92vw; text-align: left;">
      <div class="label" style="text-align:center;">Réponses</div>
      <div id="freeResultsList" class="free-list"></div>
      <div style="text-align:center; margin-top: 1rem;">
        <button id="freeResultsCloseBtn">Fermer</button>
      </div>
    </div>
  </div>

  <div id="freeReviewOverlay" class="overlay">
    <div style="max-width: 1100px; width: 94vw;">
      <div class="row" style="justify-content:space-between; align-items:center;">
        <div class="label">Correction — <span id="freeReviewPosition">1/20</span></div>
        <div class="btn-row">
          <button id="freeReviewPrevBtn">Précédent</button>
          <button id="freeReviewNextBtn" class="btn-green">Suivant</button>
          <button id="freeReviewCloseBtn" class="btn-cyan">Terminer</button>
        </div>
      </div>
      <div class="question" id="freeReviewQuestion" style="margin-top:.5rem; text-align:center;"></div>
      <div id="freeReviewList" class="free-list" style="margin-top:.8rem;"></div>
    </div>
  </div>

  <script src="/config.js"></script>
  <script src="/socket.io/socket.io.js"></script>
  <script type="module" src="/js/tv-core.js"></script>
  <script type="module" src="/js/tv-buzzer.js"></script>
  <script type="module" src="/js/tv-quiz.js"></script>
  <script type="module" src="/js/tv-guess.js"></script>
  <script type="module" src="/js/tv-free.js"></script>
</body>
</html>
